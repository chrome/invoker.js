(function(){var e,t=[].slice;e=function(){function r(){}var e,n;return r.STOP="7Jxmz}a&nst4@Y",r.settings={async:!1,defaultPriority:10,breakOnError:!0},n=function(t,n){return!!e(t).exec(n)||!!e(n).exec(t)},e=function(e){var t;return t=e.replace(/[-[\]{}()+.\\^$|#]/g,"\\$&").replace(/\?/g,".").replace(/\*/g,"(.*?)").split(/[\s,;]+/),new RegExp("(^"+t.join("$|^")+"$)")},r.publish=function(){var e,r,i,s,o,u,a,f,l,c,h,p,d,v,m;i=arguments[0],s=2<=arguments.length?t.call(arguments,1):[];if(this.subscribers==null)return!1;u=[],e=this.settings.async;for(a in this.subscribers)if(n(i,a)){p=this.subscribers[a];for(f=0,c=p.length;f<c;f++)o=p[f],u.push(o),e=e&&o.priority===this.settings.defaultPriority}e||u.sort(function(e,t){return e.priority>t.priority}),m=[];for(l=0,h=u.length;l<h;l++){o=u[l];if(e)m.push(setTimeout(function(){var e;return(e=o.callback).call.apply(e,[o.context].concat(t.call(s)))},1));else{if(this.settings.breakOnError)r=(d=o.callback).call.apply(d,[o.context].concat(t.call(s)));else try{r=(v=o.callback).call.apply(v,[o.context].concat(t.call(s)))}catch(g){setTimeout(function(){throw g},1)}if(r===this.STOP)break;m.push(void 0)}}return m},r.subscribe=function(e,t,n,r){var i,s,o,u,a,f,l,c,h;r==null&&(r=this.settings.defaultPriority),arguments.length===3&&typeof n=="number"&&(a=[n,t,void 0],r=a[0],n=a[1],t=a[2]),arguments.length===2&&(f=[t,void 0],n=f[0],t=f[1]),(l=this.subscribers)==null&&(this.subscribers={}),i=e.split(/[\s,;]+/),h=[];for(o=0,u=i.length;o<u;o++)e=i[o],(c=(s=this.subscribers)[e])==null&&(s[e]=[]),h.push(this.subscribers[e].push({callback:n,context:t,priority:r}));return h},r.unsubscribe=function(e,t,r){var i,s,o,u;if(this.subscribers==null)return!1;arguments.length===2&&typeof t=="function"&&(u=[t,void 0],r=u[0],t=u[1]),i=0;for(o in this.subscribers)if(n(e,o))if(r!=null||t!=null){s=0;while(s<this.subscribers[o].length)r!=null&&t==null&&r===this.subscribers[o][s].callback||t!=null&&r==null&&t===this.subscribers[o][s].context||r!=null&&t!=null&&t===this.subscribers[o][s].context&&r===this.subscribers[o][s].callback?this.subscribers[o].splice(s,1):s++}else delete this.subscribers[o];return i>0},r}(),typeof window!="undefined"&&window!==null?window.Invoker=e:module.exports=e}).call(this)